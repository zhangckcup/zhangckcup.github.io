clear;
x0 = [7877	7800	7375	5582	5297	7480	3138	2803	4278	4166	4529	4338
7932	7880	7206	5512	5219	7500	3003	2786	4144	4180	4406	4289
8264	8049	7419	5730	5368	7500	3000	2800	4200	4008	4500	4343
8363	8000	7483	5714	5460	7500	3033	2793	4200	4087	4500	4305
7990	7883	7143	5596	5330	7406	3160	2800	4171	4006	4526	4200];
x1 = x0(1,:);
for i=2:5;
    x1 = [x1;sum(x0(1:i,:))];
end
z = (x1(1,:)+x1(2,:))/2
for i=2:4;
    z = [z;(x1(i+1,:)+x1(i,:))/2];
end
a =[1;1]
for i =1:12;
    Y = x0(2:end,i);
    B = [-z(:,i),ones(4,1)];
    a = [a,(B'*B)^-1*B'*Y];
end
a = a(:,2:end);

x1Hat = [x0(1,3:6)',zeros(4,5)];
x0Hat = [x0(1,3:6)',zeros(4,5)];
xl = [3,5,7,9,11,13];
tit = ['朝阳区';'丰台区';'石景山';'海淀区'];
for i=1:4;
	subplot(2,2,i);
	plot(xl(1:5),x0(:,2+i),'ro');
	hold on;
	c = a(2,2+i)/a(1,2+i);
	for j=1:5;
		x1Hat(i,j+1) = (x0(1,2+i)-c)*exp(-a(1,2+i)*j)+c;
	end
	x0Hat(i,2:end) = [x1Hat(i,2:end)-x1Hat(i,1:end-1)];
	plot(xl,x0Hat(i,:),'b')
    title(tit(i,:));xlim([3,13])
end